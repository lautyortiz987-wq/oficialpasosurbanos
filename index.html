<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pasos Urbanos</title>

<script src="https://cdn.tailwindcss.com"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

<style>
@import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;700;800&display=swap');

:root {
  --brand:#3b82f6;
  --bg:#050505;
  --text:#fff;
  --card:rgba(255,255,255,.04);
}
.light-mode{
  --bg:#f8fafc;
  --text:#0f172a;
  --card:rgba(15,23,42,.06);
}
body{
  background:var(--bg);
  color:var(--text);
  font-family:'Plus Jakarta Sans',sans-serif;
  transition:.3s;
}
.glass-card{
  background:var(--card);
  border-radius:30px;
  padding:20px;
}
.size-badge{
  border:1px solid rgba(255,255,255,.2);
  padding:8px;
  border-radius:10px;
  text-align:center;
  cursor:pointer;
}
.size-badge.selected{
  background:var(--brand);
  color:white;
}
.modal-container{
  position:fixed;
  top:50%;
  left:50%;
  transform:translate(-50%,-50%);
  background:#0a0a0a;
  padding:25px;
  border-radius:30px;
  display:none;
  z-index:1000;
}
.modal-container.active{display:block}
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.7);
  display:none;
  z-index:900;
}
.overlay.active{display:block}
.theme-toggle{
  width:60px;height:30px;
  background:var(--card);
  border-radius:20px;
  cursor:pointer;
  position:relative;
}
.theme-toggle-dot{
  width:22px;height:22px;
  background:var(--brand);
  border-radius:50%;
  position:absolute;
  top:4px;left:4px;
  transition:.3s;
}
.light-mode .theme-toggle-dot{transform:translateX(30px)}
</style>
</head>

<body>

<div id="modal-overlay" class="overlay"></div>

<nav class="fixed w-full flex justify-between p-6 z-50">
  <b>PASOS <span class="text-blue-500">URBANOS</span></b>
  <div class="flex gap-4 items-center">
    <div id="theme-switch" class="theme-toggle">
      <div class="theme-toggle-dot"></div>
    </div>
    <button id="admin-trigger" class="px-4 py-2 bg-white/10 rounded-full text-xs">Staff</button>
  </div>
</nav>

<main class="pt-32 max-w-6xl mx-auto px-6">
  <h1 class="text-5xl font-black mb-10">CAT√ÅLOGO</h1>
  <div id="product-grid" class="grid md:grid-cols-3 gap-6"></div>
</main>

<!-- CHECKOUT -->
<div id="checkout-panel" class="modal-container">
  <h2 id="checkout-name" class="font-black"></h2>
  <p id="checkout-price" class="text-blue-500 mb-4"></p>
  <div id="checkout-sizes" class="grid grid-cols-4 gap-2 mb-4"></div>
  <button id="whatsapp-order-btn" class="w-full bg-green-500 py-3 rounded-xl font-black">WhatsApp</button>
  <button onclick="UI.close()" class="mt-3 text-xs opacity-50 w-full">Cerrar</button>
</div>

<!-- ADMIN -->
<div id="admin-panel" class="modal-container">
  <div id="login-view">
    <input id="admin-password-input" type="password" placeholder="Password" class="w-full p-3 mb-3 rounded-xl bg-white/10">
    <button id="admin-login-btn" class="w-full bg-blue-500 py-3 rounded-xl font-black">Entrar</button>
  </div>

  <div id="dashboard-view" class="hidden">
    <input id="p-name" placeholder="Nombre" class="w-full p-2 mb-2 rounded-xl bg-white/10">
    <input id="p-price" placeholder="Precio" class="w-full p-2 mb-2 rounded-xl bg-white/10">
    <input id="p-img" placeholder="URL Imagen" class="w-full p-2 mb-2 rounded-xl bg-white/10">

    <div id="size-selector" class="grid grid-cols-5 gap-2 mb-4">
      <span class="size-badge" data-size="38">38</span>
      <span class="size-badge" data-size="39">39</span>
      <span class="size-badge" data-size="40">40</span>
      <span class="size-badge" data-size="41">41</span>
      <span class="size-badge" data-size="42">42</span>
    </div>

    <button id="p-save-btn" class="w-full bg-blue-500 py-3 rounded-xl font-black">Publicar</button>
  </div>
</div>

<!-- ================= SCRIPT ================= -->
<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
import { getFirestore, collection, addDoc, getDocs }
from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

/* üî• PON√â TUS DATOS REALES */
const firebaseConfig = {
  apiKey: "TU_API_KEY",
  authDomain: "TU_AUTH_DOMAIN",
  projectId: "TU_PROJECT_ID",
  storageBucket: "TU_STORAGE",
  messagingSenderId: "TU_SENDER_ID",
  appId: "TU_APP_ID"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const state = {
  products: [],
  selectedProduct:null,
  selectedSize:null,
  isLight:false
};

window.UI = {
  openModal(id){
    modal-overlay.classList.add("active");
    document.getElementById(id).classList.add("active");
  },
  close(){
    document.querySelectorAll(".modal-container,.overlay")
    .forEach(e=>e.classList.remove("active"));
  },
  toggleTheme(){
    state.isLight=!state.isLight;
    document.body.classList.toggle("light-mode",state.isLight);
  },
  openCheckout(i){
    const p=state.products[i];
    state.selectedProduct=p;
    checkout-name.innerText=p.name;
    checkout-price.innerText="$"+p.price;
    checkout-sizes.innerHTML=p.sizes.map(s=>`<span class="size-badge checkout-size" data-size="${s}">${s}</span>`).join("");
    document.querySelectorAll(".checkout-size").forEach(b=>{
      b.onclick=()=>{document.querySelectorAll(".checkout-size").forEach(x=>x.classList.remove("selected"));b.classList.add("selected");state.selectedSize=b.dataset.size;}
    });
    UI.openModal("checkout-panel");
  }
};

theme-switch.onclick=UI.toggleTheme;
admin-trigger.onclick=()=>UI.openModal("admin-panel");
modal-overlay.onclick=UI.close;

admin-login-btn.onclick=()=>{
  if(admin-password-input.value==="admin123"){
    login-view.classList.add("hidden");
    dashboard-view.classList.remove("hidden");
  }
};

document.querySelectorAll("#size-selector .size-badge")
.forEach(b=>b.onclick=()=>b.classList.toggle("selected"));

p-save-btn.onclick=async()=>{
  const name=p-name.value;
  const price=p-price.value;
  const img=p-img.value;
  const sizes=[...document.querySelectorAll(".size-badge.selected")].map(s=>s.dataset.size);
  if(!name||!price||!img||!sizes.length)return;
  await addDoc(collection(db,"products"),{name,price,img,sizes});
  UI.close();
  loadProducts();
};

whatsapp-order-btn.onclick=()=>{
  if(!state.selectedSize)return;
  const msg=`Hola! ${state.selectedProduct.name} talle ${state.selectedSize}`;
  window.open("https://wa.me/5491156474987?text="+encodeURIComponent(msg));
};

function render(){
  product-grid.innerHTML=state.products.map((p,i)=>`
  <div class="glass-card cursor-pointer" onclick="UI.openCheckout(${i})">
    <img src="${p.img}" class="rounded-xl mb-3">
    <b>${p.name}</b>
    <p class="text-blue-500">$${p.price}</p>
  </div>`).join("");
}

async function loadProducts(){
  state.products=[];
  const snap=await getDocs(collection(db,"products"));
  snap.forEach(d=>state.products.push(d.data()));
  render();
}

loadProducts();
</script>

</body>
</html>
